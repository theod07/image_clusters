# image_clusters
## Test Results for taylorswift
<img src="https://scontent-lga3-1.cdninstagram.com/t51.2885-15/e35/12783439_227038377646495_165023836_n.jpg" width="250">

```
1.  Class: bolo tie, bolo, bola tie, bola.
2.  Class: buckle.
3.  Class: shield, buckler.
4.  Class: necklace.
5.  Class: purse.
6.  Class: hook, claw.
7.  Class: thimble.
8.  Class: wallet, billfold, notecase, pocketbook.
9.  Class: pick, plectrum, plectron.
10.  Class: hair slide.
11.  Class: padlock.
12.  Class: brass, memorial tablet, plaque.
13.  Class: lighter, light, igniter, ignitor.
14.  Class: breastplate, aegis, egis.
15.  Class: mailbag, postbag.
16.  Class: holster.
17.  Class: scabbard.
18.  Class: safety pin.
19.  Class: switch, electric switch, electrical switch.
20.  Class: chain.
```
<img src="https://scontent-lga3-1.cdninstagram.com/t51.2885-15/e35/p480x480/12822517_207939649567337_1477831037_n.jpg" width="250">

```
1.  Class: poncho.
2.  Class: stole.
3.  Class: abaya.
4.  Class: sweatshirt.
5.  Class: pajama, pyjama, pj's, jammies.
6.  Class: miniskirt, mini.
7.  Class: hair spray.
8.  Class: cloak.
9.  Class: cardigan.
10.  Class: hand blower, blow dryer, blow drier, hair dryer, hair drier.
11.  Class: wig.
12.  Class: vestment.
13.  Class: chain mail, ring mail, mail, chain armor, chain armour, ring armor, ring armour.
14.  Class: feather boa, boa.
15.  Class: wool, woolen, woollen.
16.  Class: shower curtain.
17.  Class: ski mask.
18.  Class: jersey, T-shirt, tee shirt.
19.  Class: mortarboard.
20.  Class: plunger, plumber's helper.
```
<img src="https://scontent-lga3-1.cdninstagram.com/t51.2885-15/e35/12747622_2170634363077265_1965558059_n.jpg" width="250" >

```
1.  Class: traffic light, traffic signal, stoplight.
2.  Class: punching bag, punch bag, punching ball, punchball.
3.  Class: loudspeaker, speaker, speaker unit, loudspeaker system, speaker system.
4.  Class: mouse, computer mouse.
5.  Class: book jacket, dust cover, dust jacket, dust wrapper.
6.  Class: brassiere, bra, bandeau.
7.  Class: dumbbell.
8.  Class: abacus.
9.  Class: joystick.
10.  Class: clog, geta, patten, sabot.
11.  Class: sock.
12.  Class: cowboy hat, ten-gallon hat.
13.  Class: bathing cap, swimming cap.
14.  Class: maraca.
15.  Class: microphone, mike.
16.  Class: sunglasses, dark glasses, shades.
17.  Class: ladle.
18.  Class: knee pad.
19.  Class: maillot, tank suit.
20.  Class: pick, plectrum, plectron.
```
<img src="https://scontent-lga3-1.cdninstagram.com/t51.2885-15/e35/p480x480/11371996_1990507964506737_1940515606_n.jpg" width="250" >

```
1.  Class: suit, suit of clothes.
2.  Class: bow tie, bow-tie, bowtie.
3.  Class: stole.
4.  Class: velvet.
5.  Class: Windsor tie.
6.  Class: gown.
7.  Class: miniskirt, mini.
8.  Class: jean, blue jean, denim.
9.  Class: maillot.
10.  Class: cardigan.
11.  Class: maillot, tank suit.
12.  Class: overskirt.
13.  Class: academic gown, academic robe, judge's robe.
14.  Class: cloak.
15.  Class: mortarboard.
16.  Class: sunglasses, dark glasses, shades.
17.  Class: wool, woolen, woollen.
18.  Class: bulletproof vest.
19.  Class: sunglass.
20.  Class: trench coat.
```

<img src="https://scontent-lga3-1.cdninstagram.com/t51.2885-15/s750x750/sh0.08/e35/12728514_1688943401393583_1138769393_n.jpg" width="250" >

```
1.  Class: bow tie, bow-tie, bowtie.
2.  Class: suit, suit of clothes.
3.  Class: gown.
4.  Class: groom, bridegroom.
5.  Class: limousine, limo.
6.  Class: Windsor tie.
7.  Class: theater curtain, theatre curtain.
8.  Class: abaya.
9.  Class: jean, blue jean, denim.
10.  Class: overskirt.
11.  Class: wig.
12.  Class: cloak.
13.  Class: miniskirt, mini.
14.  Class: mortarboard.
15.  Class: hoopskirt, crinoline.
16.  Class: stage.
17.  Class: Loafer.
18.  Class: neck brace.
19.  Class: grand piano, grand.
20.  Class: academic gown, academic robe, judge's robe.
```
<br>

## Test Results for zooeydeschanel
<img src="https://scontent-lga3-1.cdninstagram.com/t51.2885-15/e15/10729407_1550826631854920_835795974_n.jpg" width="250">

```
1.  Class: ocarina, sweet potato.
2.  Class: harmonica, mouth organ, harp, mouth harp.
3.  Class: sunglasses, dark glasses, shades.
4.  Class: microphone, mike.
5.  Class: stage.
6.  Class: wig.
7.  Class: cellular telephone, cellular phone, cellphone, cell, mobile phone.
8.  Class: hair spray.
9.  Class: miniskirt, mini.
10.  Class: lipstick, lip rouge.
11.  Class: bubble.
12.  Class: sunglass.
13.  Class: whistle.
14.  Class: stethoscope.
15.  Class: jean, blue jean, denim.
16.  Class: crutch.
17.  Class: flute, transverse flute.
18.  Class: brassiere, bra, bandeau.
19.  Class: pay-phone, pay-station.
20.  Class: violin, fiddle.
```
<img src="https://scontent-lga3-1.cdninstagram.com/t51.2885-15/e35/12317860_196424194035731_178014184_n.jpg" width="250" >

```
1.  Class: bottlecap.
2.  Class: rugby ball.
3.  Class: volleyball.
4.  Class: soccer ball.
5.  Class: football helmet.
6.  Class: puck, hockey puck.
7.  Class: crash helmet.
8.  Class: racket, racquet.
9.  Class: pick, plectrum, plectron.
10.  Class: ping-pong ball.
11.  Class: pop bottle, soda bottle.
12.  Class: oil filter.
13.  Class: tennis ball.
14.  Class: bathing cap, swimming cap.
15.  Class: shield, buckler.
16.  Class: basketball.
17.  Class: punching bag, punch bag, punching ball, punchball.
18.  Class: croquet ball.
19.  Class: baseball.
20.  Class: loupe, jeweler's loupe.
```

<img src="https://scontent-lga3-1.cdninstagram.com/t51.2885-15/e35/12784059_1528739680760441_344179689_n.jpg" width="250" >

```
n+1: 1.  Class: wig.
n+1: 2.  Class: hair spray.
n+1: 3.  Class: oboe, hautboy, hautbois.
n+1: 4.  Class: stethoscope.
n+1: 5.  Class: Band Aid.
n+1: 6.  Class: lab coat, laboratory coat.
n+1: 7.  Class: book jacket, dust cover, dust jacket, dust wrapper.
n+1: 8.  Class: face powder.
n+1: 9.  Class: lipstick, lip rouge.
n+1: 10.  Class: jersey, T-shirt, tee shirt.
n+1: 11.  Class: bassoon.
n+1: 12.  Class: web site, website, internet site, site.
n+1: 13.  Class: lotion.
n+1: 14.  Class: neck brace.
n+1: 15.  Class: sunscreen, sunblock, sun blocker.
n+1: 16.  Class: perfume, essence.
n+1: 17.  Class: brassiere, bra, bandeau.
n+1: 18.  Class: maillot.
n+1: 19.  Class: suit, suit of clothes.
n+1: 20.  Class: syringe.
```

<img src="https://scontent-lga3-1.cdninstagram.com/t51.2885-15/s750x750/sh0.08/e35/12797842_245709435762417_302545047_n.jpg" width="250">

```
n+1: 1.  Class: candle, taper, wax light.
n+1: 2.  Class: restaurant, eating house, eating place, eatery.
n+1: 3.  Class: dining table, board.
n+1: 4.  Class: patio, terrace.
n+1: 5.  Class: grand piano, grand.
n+1: 6.  Class: altar.
n+1: 7.  Class: groom, bridegroom.
n+1: 8.  Class: tub, vat.
n+1: 9.  Class: mortar.
n+1: 10.  Class: studio couch, day bed.
n+1: 11.  Class: paper towel.
n+1: 12.  Class: pot, flowerpot.
n+1: 13.  Class: home theater, home theatre.
n+1: 14.  Class: iron, smoothing iron.
n+1: 15.  Class: lab coat, laboratory coat.
n+1: 16.  Class: red wine.
n+1: 17.  Class: abacus.
n+1: 18.  Class: scale, weighing machine.
n+1: 19.  Class: ice lolly, lolly, lollipop, popsicle.
n+1: 20.  Class: grocery store, grocery, food market, market.
```

<img src="https://scontent-lga3-1.cdninstagram.com/t51.2885-15/e35/10631999_1187324901297530_2118958455_n.jpg" width="250" >

```
n+1: 1.  Class: cellular telephone, cellular phone, cellphone, cell, mobile phone.
n+1: 2.  Class: grocery store, grocery, food market, market.
n+1: 3.  Class: shoe shop, shoe-shop, shoe store.
n+1: 4.  Class: abaya.
n+1: 5.  Class: butcher shop, meat market.
n+1: 6.  Class: fur coat.
n+1: 7.  Class: groom, bridegroom.
n+1: 8.  Class: ocarina, sweet potato.
n+1: 9.  Class: restaurant, eating house, eating place, eatery.
n+1: 10.  Class: hotdog, hot dog, red hot.
n+1: 11.  Class: pretzel.
n+1: 12.  Class: wig.
n+1: 13.  Class: hair spray.
n+1: 14.  Class: confectionery, confectionary, candy store.
n+1: 15.  Class: trench coat.
n+1: 16.  Class: bow tie, bow-tie, bowtie.
n+1: 17.  Class: cauliflower.
n+1: 18.  Class: bakery, bakeshop, bakehouse.
n+1: 19.  Class: miniskirt, mini.
n+1: 20.  Class: lipstick, lip rouge.
```

<br>
## SQLite
### PostGres
### psycopg


<br>
## MongoDB
### Installing MongoDB
RDBMS	MongoDB
Database	Database
Table	Collection
Tuple/Row	Document
column	Field
Table Join	Embedded Documents
Primary Key	Primary Key (Default key _id provided by mongodb itself)
Database Server and Client
Mysqld/Oracle	mongod
mysql/sqlplus	mongo

Find out the info of your machine. For Ubuntu:
```
$ lsb_release -a
No LSB modules are available.
Distributor ID: Ubuntu
Description:    Ubuntu 14.04.3 LTS
Release:        14.04
Codename:       trusty
```
Instructions [here](https://docs.mongodb.org/master/tutorial/install-mongodb-on-ubuntu/)
1. Import the public key.
2. Create a list file for MongoDB
3. Reload local package database.
4. Install the latest stable version of MongoDB.
5. ( ** Pin a specific version of MongoDB ** )
```
sudo apt-key adv --keyserver hkp://keyserver.ubuntu.com:80 --recv EA312927
echo "deb http://repo.mongodb.org/apt/ubuntu trusty/mongodb-org/3.2 multiverse" | sudo tee /etc/apt/sources.list.d/mongodb-org-3.2.list
sudo apt-get update
sudo apt-get install -y mongodb-org
echo "mongodb-org hold" | sudo dpkg --set-selections
echo "mongodb-org-server hold" | sudo dpkg --set-selections
echo "mongodb-org-shell hold" | sudo dpkg --set-selections
echo "mongodb-org-mongos hold" | sudo dpkg --set-selections
echo "mongodb-org-tools hold" | sudo dpkg --set-selections
```

### Running MongoDB
```
tmux new -s mongod
sudo mongod
```
Be careful: pymongo will let you insert the same row of information multiple times without error.
If you're trying to modify a row that's already in the table, use `.update_one()` or `.find_one_and_update()`

<br>
Run MongoDB Community Edition
1. Start MongoDB

    sudo service mongod start

2. Verify that MongoDB has started successfully

    [initandlisten] waiting for connections on port <port>

3. Stop MongoDB

    sudo service mongod stop

4. Restart MongoDB

    sudo service mongod restart


<br>

## rendering images on EC2
AWS ec2 instances don't have capability to render images, which poses a problem while we're trying to load images. The popular/common packages that are used to load images (`PILLOW`, `matplotlib.pyplot`, `skimage.io`) seem to rely on image render-fication.
Let's see if we can figure out how to configure `matplotlib` to suit our needs..

learn about [matplotlib's backend](http://matplotlib.org/faq/usage_faq.html#what-is-a-backend)
renderer 'AGG' seems to be working okay for reading in images.
`Note`: it's not helpful to add the command into the script. I had to modify the matplotlibrc file to get it to run properly.

<br>

## scp
Examples

Copy the file "foobar.txt" from a remote host to the local host

    $ scp your_username@remotehost.edu:foobar.txt /some/local/directory
Copy the file "foobar.txt" from the local host to a remote host

    $ scp foobar.txt your_username@remotehost.edu:/some/remote/directory
Copy the directory "foo" from the local host to a remote host's directory "bar"

    $ scp -r foo your_username@remotehost.edu:/some/remote/directory/bar
Copy the file "foobar.txt" from remote host "rh1.edu" to remote host "rh2.edu"

    $ scp your_username@rh1.edu:/some/remote/directory/foobar.txt \
your_username@rh2.edu:/some/remote/directory/
Copying the files "foo.txt" and "bar.txt" from the local host to your home directory on the remote host

    $ scp foo.txt bar.txt your_username@remotehost.edu:~
Copy the file "foobar.txt" from the local host to a remote host using port 2264

    $ scp -P 2264 foobar.txt your_username@remotehost.edu:/some/remote/directory
Copy multiple files from the remote host to your current directory on the local host

    $ scp your_username@remotehost.edu:/some/remote/directory/\{a,b,c\} .
    $ scp your_username@remotehost.edu:~/\{foo.txt,bar.txt\} .


<br>

## tmux
start new:

    tmux

start new with session name:

    tmux new -s myname

attach:

    tmux a  #  (or at, or attach)

attach to named:

    tmux a -t myname

list sessions:

    tmux ls

<a name="killSessions"></a>kill session:

    tmux kill-session -t myname

<br>

## Scraping
open up the site, open up developer tools with `cmd+option+i` and look at the network tab. the request URL for each image should be listed.


<br>

## MongoDB Structure
Store data for each item in a nested dictionary.
Dictionary top level is keyed by users.
Level two is keyed by each img.
Level three is keyed by the information of the img.

```json
{ { "user1" :
      { "img1" :
          { "key" : "special hash string identifier",
            "src_url" : "url for full image",
            "vector" : "output vector from AlexNet",
            "cluster" : "result of cluster algorithm" } },
      { "img2" :
          { "key" : "special hash string identifier",
            "src_url" : "url for full image",
            "vector" : "output vector from AlexNet",
            "cluster" : "result of cluster algorithm" } } },
    { "user2" :
        { "img1" :
            { "key" : "special hash string identifier",
              "src_url" : "url for full image",
              "vector" : "output vector from AlexNet",
              "cluster" : "result of cluster algorithm" } },
        { "img2" :
            { "key" : "special hash string identifier",
              "src_url" : "url for full image",
              "vector" : "output vector from AlexNet",
              "cluster" : "result of cluster algorithm" } } }
}
```

<br>

## Setting up Lasagne

1.Verify you have Python2.7 or Python3.4
```python
```

2. Create new environment. Make sure you switch over to that environment.
```python
conda create --name lasagne_env python=2
source activate lasagne_env
```
3. Install C compiler for OSX via pip
```python
pip install clang
```
4. Update numpy to v1.6.2 or greater. Update scipy to v0.11 or greater.
```python
conda install numpy
conda install scipy
```
5. Run command below to get the latest known good version of Theano
```python
pip install -r https://raw.githubusercontent.com/Lasagne/Lasagne/v0.1/requirements.txt
```
6. Install Lasagne
```python
pip install Lasagne==0.1
```
7.

<br>

## Troubleshooting
Ran into an issue while going through the tutorial. running example/mnist.py gave the following error:
```python
$ python mnist.py
Loading data...
Downloading train-images-idx3-ubyte.gz
Downloading train-labels-idx1-ubyte.gz
Downloading t10k-images-idx3-ubyte.gz
Downloading t10k-labels-idx1-ubyte.gz
Building model and compiling functions...
Traceback (most recent call last):
  File "mnist.py", line 359, in <module>
    main(**kwargs)
  File "mnist.py", line 281, in main
    train_fn = theano.function([input_var, target_var], loss, updates=updates)
  File "/Users/wonder/anaconda/envs/lasagne_env/lib/python2.7/site-packages/theano/compile/function.py", line 316, in function
    output_keys=output_keys)
  File "/Users/wonder/anaconda/envs/lasagne_env/lib/python2.7/site-packages/theano/compile/pfunc.py", line 523, in pfunc
    output_keys=output_keys)
  File "/Users/wonder/anaconda/envs/lasagne_env/lib/python2.7/site-packages/theano/compile/function_module.py", line 1526, in orig_function
    defaults)
  File "/Users/wonder/anaconda/envs/lasagne_env/lib/python2.7/site-packages/theano/compile/function_module.py", line 1390, in create
    input_storage=input_storage_lists)
  File "/Users/wonder/anaconda/envs/lasagne_env/lib/python2.7/site-packages/theano/gof/link.py", line 607, in make_thunk
    output_storage=output_storage)[:3]
  File "/Users/wonder/anaconda/envs/lasagne_env/lib/python2.7/site-packages/theano/gof/vm.py", line 1025, in make_all
    no_recycling))
  File "/Users/wonder/anaconda/envs/lasagne_env/lib/python2.7/site-packages/theano/gof/op.py", line 807, in make_thunk
    no_recycling)
  File "/Users/wonder/anaconda/envs/lasagne_env/lib/python2.7/site-packages/theano/gof/op.py", line 733, in make_c_thunk
    output_storage=node_output_storage)
  File "/Users/wonder/anaconda/envs/lasagne_env/lib/python2.7/site-packages/theano/gof/cc.py", line 1065, in make_thunk
    keep_lock=keep_lock)
  File "/Users/wonder/anaconda/envs/lasagne_env/lib/python2.7/site-packages/theano/gof/cc.py", line 1007, in __compile__
    keep_lock=keep_lock)
  File "/Users/wonder/anaconda/envs/lasagne_env/lib/python2.7/site-packages/theano/gof/cc.py", line 1435, in cthunk_factory
    key=key, lnk=self, keep_lock=keep_lock)
  File "/Users/wonder/anaconda/envs/lasagne_env/lib/python2.7/site-packages/theano/gof/cmodule.py", line 1094, in module_from_key
    module = lnk.compile_cmodule(location)
  File "/Users/wonder/anaconda/envs/lasagne_env/lib/python2.7/site-packages/theano/gof/cc.py", line 1347, in compile_cmodule
    preargs=preargs)
  File "/Users/wonder/anaconda/envs/lasagne_env/lib/python2.7/site-packages/theano/gof/cmodule.py", line 2068, in compile_str
    return dlimport(lib_filename)
  File "/Users/wonder/anaconda/envs/lasagne_env/lib/python2.7/site-packages/theano/gof/cmodule.py", line 297, in dlimport
    rval = __import__(module_name, {}, {}, [module_name])
ImportError: ('The following error happened while compiling the node', Dot22(Flatten{2}.0, W), '\n', 'dlopen(/Users/wonder/.theano/compiledir_Darwin-14.5.0-x86_64-i386-64bit-i386-2.7.11-64/tmp5TsaA5/15357f4a51bff61fa945bea566107bed.so, 2): Library not loaded: libmkl_intel_lp64.dylib\n  Referenced from: /Users/wonder/.theano/compiledir_Darwin-14.5.0-x86_64-i386-64bit-i386-2.7.11-64/tmp5TsaA5/15357f4a51bff61fa945bea566107bed.so\n  Reason: image not found', '[Dot22(<TensorType(float64, matrix)>, W)]')
```

Recommendation from nouiz ([here](https://groups.google.com/forum/#!topic/theano-users/DcOZvOJqxUU)) is to use the bleeding edge versions.
```python
pip install --upgrade https://github.com/Theano/Theano/archive/master.zip
pip install --upgrade https://github.com/Lasagne/Lasagne/archive/master.zip
```

Ran mnist.py again after installation. Everything went well!
  | Hardware      | Train Time    |       |
  | ------------- |:-------------:| -----:|
  | MBP (12,1)    | ~15 sec/epoch |       |
  | AWS t2.micro  | ~25 sec/epoch |       |
  | AWS g2.8xlarge| ~1.5 sec/epoch|       |
