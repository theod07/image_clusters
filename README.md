# image_clusters
## Narrowing down the stethoscope
on a g2.8xlarge ec2, vgg16 is taking about 4sec/photo on lasagne, which comes out to about 21,000 photos in a day. that's far too slow, especially considering our code gets frozen in 7 days. keep in mind that i haven't even gotten to the clustering step of this project. so to be able to get some preliminary results, we'll have to strategize which users to analyze. the celebrity profiles so far are just noise -- tswizzle and miss zooeyd.

What I can do is pick a few users who are already thematic and find clusters for those photos.
Here are some themes we may be able to use and the users who could belong to each:
1. dogs (igtoppicture, postagram)
2. cats
3. food (jamieoliver, foodzie, love_food, matthewjennings, benandjerrys, dunkindonuts)
4. nature (natgeo, solar, beauty_edit_max, convergence, dudubarina, gopro, indotravellers.co, instagrambrasil, mexicotravel)
5. sports (trey5, sacramentokings, redbull, realmadrid, philadelphiaeagles, patriots, okcthunder, nyknicks, nyrangers, futbolsport, garethbale11, manchesterunited, lakers, miamiheat, nba, nhl,  433 soccer-but-many-vids, jamesrodriguez10)
6. fashion / style (worthwhilestyle, urbanoutfitters, trendiest, sweetyberryz, rainyseasonshop, nylonmag, burberry, GAP, amazing_pretty, bergdorfs, bonobos, chanelofficial, cintageshop, dress_varietyii, forever21, freedom_clothes, gradient, hm, ideal, louisvuitton, manrepeller, mercihouse, paniexx_shop)
7. fitness (toppeopleworld, adidas, fitness_elites, nike)
8. science / technology (nasagoddard, cultofmac, generalelectric, nasa)
9. babies / nature (alukoyanov)
10. hairstyle (barbershopconnect)
11. architecture / urban (nycmayorsoffice, nickbilton, barcelonacitizen, beautifulworldgroup, darenta.ru, hangarang, highlinenyc, keepsy)
12. selfies (bellathorne, caiocastro, camerondallas, caradelevigne, jessicaalba, jlo, justinbieber)
13. shoes (toms, sellkixcity, sellsneakershere, puma, nikefootball, bigfeetsneaks, adidasoriginals, converse, gucci, i_queens, kicks4sale)
14. artistic (walaad, photogeekdom, photojojo, charlesdharapak, eyemediaa, fotogasm, giftbuddy, uselected,  harrystyles, instagram, instahaiku, livepainter, nationalpost, netofernandez7)
15. drinks (starbucks, stumptowncoffee, dogfishbeer
16. makeup / accessories (warbyparker, wakeupandmakeup, fashion_creative_love, fashionbeautydisplay, fashionchurch, glamherous, hudabeauty, katespadeny, makegirlz, nailsvideos, )
17. cars (theultimateclub, girlscar, internetpoet, scobleizer, smsaruae)
18. models (victoriassecret, shaym, gigihadid, instagramtop50, marinaruybarbosa, modelisy, negin_mirsalehi)
19. motox, snowboarding (jeremymcgrath2, jimmiejohnson)
20. surfing (julian_wilson)
21. spiritual (nonghairstylist3245)
22. animals (oceana, paolatonight)
23. news (wired, reuters, npr, nbcnews, todayshow)
24. celebrity (zooeydeschanel, vindiesel, vanessahudgens, tyrabanks, treysongz, tonyhawk, therock, theellenshow, taylorswift, shakira, shawnjohnson, selenagomez, ryanseacrest, robertdobbsarmy, kimkardashian, taylorswift, zooeydeschanel, ronaldinhooficial, )
25. tattoos (skinart_mag, thekatvond)
26. bands (theroxy, theshins, )

food/nature/architecture twheat, ivmikspb, karaswisher, keysik, kokoulin, niksidorkin, phenom, repostapp, rrharisov.life,
animals/style/architecture izdato_eng, marshanskiy, myhusbandtrue, patricknorton
flowers/feminine (laurenconrad)
cars/menstyle/selfies (letthelordbewithyou)
nickster2k
nickkristof
year




any other suggestions?



<br>

## Test Results for ImageNet test set
<img src="http://farm1.static.flickr.com/8/11912062_a1dda4fa83.jpg" width="250">

```
1.  Class: malinois.
2.  Class: German shepherd, German shepherd dog, German police dog, alsatian.
3.  Class: Norwegian elkhound, elkhound.
4.  Class: Irish terrier.
5.  Class: Border terrier.
6.  Class: Leonberg.
7.  Class: Rhodesian ridgeback.
8.  Class: chow, chow chow.
9.  Class: bull mastiff.
10.  Class: redbone.
11.  Class: bloodhound, sleuthhound.
12.  Class: Rottweiler.
13.  Class: dingo, warrigal, warragal, Canis dingo.
14.  Class: Tibetan mastiff.
15.  Class: Irish wolfhound.
16.  Class: kelpie.
17.  Class: Chesapeake Bay retriever.
18.  Class: American Staffordshire terrier, Staffordshire terrier, American pit bull terrier, pit bull terrier.
19.  Class: soft-coated wheaten terrier.
20.  Class: Staffordshire bullterrier, Staffordshire bull terrier.
```
<img src="http://farm4.static.flickr.com/3649/3320711239_0663522aca.jpg" width="250">

```
1.  Class: shovel.
2.  Class: barrow, garden cart, lawn cart, wheelbarrow.
3.  Class: hatchet.
4.  Class: padlock.
5.  Class: bucket, pail.
6.  Class: milk can.
7.  Class: ladle.
8.  Class: plunger, plumber's helper.
9.  Class: clog, geta, patten, sabot.
10.  Class: picket fence, paling.
11.  Class: nail.
12.  Class: plow, plough.
13.  Class: hammer.
14.  Class: worm fence, snake fence, snake-rail fence, Virginia fence.
15.  Class: broom.
16.  Class: hook, claw.
17.  Class: ashcan, trash can, garbage can, wastebin, ash bin, ash-bin, ashbin, dustbin, trash barrel, trash bin.
18.  Class: barrel, cask.
19.  Class: switch, electric switch, electrical switch.
20.  Class: mortar.
```
<img src="http://farm4.static.flickr.com/3057/2975067450_98bec812af.jpg" width="250">

```
1.  Class: wild boar, boar, Sus scrofa.
2.  Class: hog, pig, grunter, squealer, Sus scrofa.
3.  Class: warthog.
4.  Class: hyena, hyaena.
5.  Class: brown bear, bruin, Ursus arctos.
6.  Class: African hunting dog, hyena dog, Cape hunting dog, Lycaon pictus.
7.  Class: American black bear, black bear, Ursus americanus, Euarctos americanus.
8.  Class: baboon.
9.  Class: timber wolf, grey wolf, gray wolf, Canis lupus.
10.  Class: bison.
11.  Class: ibex, Capra ibex.
12.  Class: armadillo.
13.  Class: echidna, spiny anteater, anteater.
14.  Class: wombat.
15.  Class: sloth bear, Melursus ursinus, Ursus ursinus.
16.  Class: beaver.
17.  Class: kit fox, Vulpes macrotis.
18.  Class: dhole, Cuon alpinus.
19.  Class: water buffalo, water ox, Asiatic buffalo, Bubalus bubalis.
20.  Class: porcupine, hedgehog.
```
<img src="http://farm3.static.flickr.com/2452/3932323110_833174f459.jpg" width="250">

```
1.  Class: hair slide.
2.  Class: piggy bank, penny bank.
3.  Class: necklace.
4.  Class: chest.
5.  Class: pillow.
6.  Class: perfume, essence.
7.  Class: mask.
8.  Class: teapot.
9.  Class: altar.
10.  Class: vase.
11.  Class: clog, geta, patten, sabot.
12.  Class: china cabinet, china closet.
13.  Class: pitcher, ewer.
14.  Class: buckle.
15.  Class: mailbag, postbag.
16.  Class: sandal.
17.  Class: brassiere, bra, bandeau.
18.  Class: teddy, teddy bear.
19.  Class: purse.
20.  Class: thimble.
```
<img src="http://www.tmk.com/tiger/6F5S5684-l.jpg" width="250">

```
1.  Class: Persian cat.
2.  Class: tabby, tabby cat.
3.  Class: lynx, catamount.
4.  Class: washbasin, handbasin, washbowl, lavabo, wash-hand basin.
5.  Class: plastic bag.
6.  Class: tiger cat.
7.  Class: Egyptian cat.
8.  Class: paper towel.
9.  Class: refrigerator, icebox.
10.  Class: tub, vat.
11.  Class: toilet seat.
12.  Class: ping-pong ball.
13.  Class: washer, automatic washer, washing machine.
14.  Class: carton.
15.  Class: toilet tissue, toilet paper, bathroom tissue.
16.  Class: dishwasher, dish washer, dishwashing machine.
17.  Class: bathtub, bathing tub, bath, tub.
18.  Class: bucket, pail.
19.  Class: radiator.
20.  Class: printer.
```

<img src="http://farm1.static.flickr.com/36/97763609_649f72b6f0.jpg" width="250" >

```
1.  Class: picket fence, paling.
2.  Class: worm fence, snake fence, snake-rail fence, Virginia fence.
3.  Class: radiator.
4.  Class: bannister, banister, balustrade, balusters, handrail.
5.  Class: mailbox, letter box.
6.  Class: breakwater, groin, groyne, mole, bulwark, seawall, jetty.
7.  Class: stone wall.
8.  Class: park bench.
9.  Class: swab, swob, mop.
10.  Class: sliding door.
11.  Class: chainlink fence.
12.  Class: pier.
13.  Class: prison, prison house.
14.  Class: daisy.
15.  Class: ashcan, trash can, garbage can, wastebin, ash bin, ash-bin, ashbin, dustbin, trash barrel, trash bin.
16.  Class: barn.
17.  Class: broom.
18.  Class: barrel, cask.
19.  Class: folding chair.
20.  Class: coral fungus.
```
<img src="http://farm4.static.flickr.com/3196/2621289202_2ac494f086.jpg" width="250">

```
1.  Class: racer, race car, racing car.
2.  Class: police van, police wagon, paddy wagon, patrol wagon, wagon, black Maria.
3.  Class: sports car, sport car.
4.  Class: passenger car, coach, carriage.
5.  Class: ambulance.
6.  Class: car wheel.
7.  Class: cab, hack, taxi, taxicab.
8.  Class: minibus.
9.  Class: minivan.
10.  Class: beach wagon, station wagon, wagon, estate car, beach waggon, station waggon, waggon.
11.  Class: convertible.
12.  Class: moving van.
13.  Class: crash helmet.
14.  Class: grille, radiator grille.
15.  Class: pickup, pickup truck.
16.  Class: tow truck, tow car, wrecker.
17.  Class: limousine, limo.
18.  Class: jeep, landrover.
19.  Class: snowmobile.
20.  Class: go-kart.
```
<img src="http://farm2.static.flickr.com/1247/1311166209_2334f85bd2.jpg" width="250">

```
1.  Class: whippet.
2.  Class: Saluki, gazelle hound.
3.  Class: Italian greyhound.
4.  Class: Ibizan hound, Ibizan Podenco.
5.  Class: basenji.
6.  Class: muzzle.
7.  Class: borzoi, Russian wolfhound.
8.  Class: Great Dane.
9.  Class: Scottish deerhound, deerhound.
10.  Class: Irish wolfhound.
11.  Class: American Staffordshire terrier, Staffordshire terrier, American pit bull terrier, pit bull terrier.
12.  Class: wallaby, brush kangaroo.
13.  Class: boxer.
14.  Class: malinois.
15.  Class: gazelle.
16.  Class: impala, Aepyceros melampus.
17.  Class: Weimaraner.
18.  Class: African hunting dog, hyena dog, Cape hunting dog, Lycaon pictus.
19.  Class: Rhodesian ridgeback.
20.  Class: bighorn, bighorn sheep, cimarron, Rocky Mountain bighorn, Rocky Mountain sheep, Ovis canadensis.
```

## Test Results for taylorswift
<img src="https://scontent-lga3-1.cdninstagram.com/t51.2885-15/e35/12783439_227038377646495_165023836_n.jpg" width="250">

```
1.  Class: bolo tie, bolo, bola tie, bola.
2.  Class: buckle.
3.  Class: shield, buckler.
4.  Class: necklace.
5.  Class: purse.
6.  Class: hook, claw.
7.  Class: thimble.
8.  Class: wallet, billfold, notecase, pocketbook.
9.  Class: pick, plectrum, plectron.
10.  Class: hair slide.
11.  Class: padlock.
12.  Class: brass, memorial tablet, plaque.
13.  Class: lighter, light, igniter, ignitor.
14.  Class: breastplate, aegis, egis.
15.  Class: mailbag, postbag.
16.  Class: holster.
17.  Class: scabbard.
18.  Class: safety pin.
19.  Class: switch, electric switch, electrical switch.
20.  Class: chain.
```
<img src="https://scontent-lga3-1.cdninstagram.com/t51.2885-15/e35/p480x480/12822517_207939649567337_1477831037_n.jpg" width="250">

```
1.  Class: poncho.
2.  Class: stole.
3.  Class: abaya.
4.  Class: sweatshirt.
5.  Class: pajama, pyjama, pj's, jammies.
6.  Class: miniskirt, mini.
7.  Class: hair spray.
8.  Class: cloak.
9.  Class: cardigan.
10.  Class: hand blower, blow dryer, blow drier, hair dryer, hair drier.
11.  Class: wig.
12.  Class: vestment.
13.  Class: chain mail, ring mail, mail, chain armor, chain armour, ring armor, ring armour.
14.  Class: feather boa, boa.
15.  Class: wool, woolen, woollen.
16.  Class: shower curtain.
17.  Class: ski mask.
18.  Class: jersey, T-shirt, tee shirt.
19.  Class: mortarboard.
20.  Class: plunger, plumber's helper.
```
<img src="https://scontent-lga3-1.cdninstagram.com/t51.2885-15/e35/12747622_2170634363077265_1965558059_n.jpg" width="250" >

```
1.  Class: traffic light, traffic signal, stoplight.
2.  Class: punching bag, punch bag, punching ball, punchball.
3.  Class: loudspeaker, speaker, speaker unit, loudspeaker system, speaker system.
4.  Class: mouse, computer mouse.
5.  Class: book jacket, dust cover, dust jacket, dust wrapper.
6.  Class: brassiere, bra, bandeau.
7.  Class: dumbbell.
8.  Class: abacus.
9.  Class: joystick.
10.  Class: clog, geta, patten, sabot.
11.  Class: sock.
12.  Class: cowboy hat, ten-gallon hat.
13.  Class: bathing cap, swimming cap.
14.  Class: maraca.
15.  Class: microphone, mike.
16.  Class: sunglasses, dark glasses, shades.
17.  Class: ladle.
18.  Class: knee pad.
19.  Class: maillot, tank suit.
20.  Class: pick, plectrum, plectron.
```
<img src="https://scontent-lga3-1.cdninstagram.com/t51.2885-15/e35/p480x480/11371996_1990507964506737_1940515606_n.jpg" width="250" >

```
1.  Class: suit, suit of clothes.
2.  Class: bow tie, bow-tie, bowtie.
3.  Class: stole.
4.  Class: velvet.
5.  Class: Windsor tie.
6.  Class: gown.
7.  Class: miniskirt, mini.
8.  Class: jean, blue jean, denim.
9.  Class: maillot.
10.  Class: cardigan.
11.  Class: maillot, tank suit.
12.  Class: overskirt.
13.  Class: academic gown, academic robe, judge's robe.
14.  Class: cloak.
15.  Class: mortarboard.
16.  Class: sunglasses, dark glasses, shades.
17.  Class: wool, woolen, woollen.
18.  Class: bulletproof vest.
19.  Class: sunglass.
20.  Class: trench coat.
```

<img src="https://scontent-lga3-1.cdninstagram.com/t51.2885-15/s750x750/sh0.08/e35/12728514_1688943401393583_1138769393_n.jpg" width="250" >

```
1.  Class: bow tie, bow-tie, bowtie.
2.  Class: suit, suit of clothes.
3.  Class: gown.
4.  Class: groom, bridegroom.
5.  Class: limousine, limo.
6.  Class: Windsor tie.
7.  Class: theater curtain, theatre curtain.
8.  Class: abaya.
9.  Class: jean, blue jean, denim.
10.  Class: overskirt.
11.  Class: wig.
12.  Class: cloak.
13.  Class: miniskirt, mini.
14.  Class: mortarboard.
15.  Class: hoopskirt, crinoline.
16.  Class: stage.
17.  Class: Loafer.
18.  Class: neck brace.
19.  Class: grand piano, grand.
20.  Class: academic gown, academic robe, judge's robe.
```
<br>

## Test Results for zooeydeschanel
<img src="https://scontent-lga3-1.cdninstagram.com/t51.2885-15/e15/10729407_1550826631854920_835795974_n.jpg" width="250">

```
1.  Class: ocarina, sweet potato.
2.  Class: harmonica, mouth organ, harp, mouth harp.
3.  Class: sunglasses, dark glasses, shades.
4.  Class: microphone, mike.
5.  Class: stage.
6.  Class: wig.
7.  Class: cellular telephone, cellular phone, cellphone, cell, mobile phone.
8.  Class: hair spray.
9.  Class: miniskirt, mini.
10.  Class: lipstick, lip rouge.
11.  Class: bubble.
12.  Class: sunglass.
13.  Class: whistle.
14.  Class: stethoscope.
15.  Class: jean, blue jean, denim.
16.  Class: crutch.
17.  Class: flute, transverse flute.
18.  Class: brassiere, bra, bandeau.
19.  Class: pay-phone, pay-station.
20.  Class: violin, fiddle.
```
<img src="https://scontent-lga3-1.cdninstagram.com/t51.2885-15/e35/12317860_196424194035731_178014184_n.jpg" width="250" >

```
1.  Class: bottlecap.
2.  Class: rugby ball.
3.  Class: volleyball.
4.  Class: soccer ball.
5.  Class: football helmet.
6.  Class: puck, hockey puck.
7.  Class: crash helmet.
8.  Class: racket, racquet.
9.  Class: pick, plectrum, plectron.
10.  Class: ping-pong ball.
11.  Class: pop bottle, soda bottle.
12.  Class: oil filter.
13.  Class: tennis ball.
14.  Class: bathing cap, swimming cap.
15.  Class: shield, buckler.
16.  Class: basketball.
17.  Class: punching bag, punch bag, punching ball, punchball.
18.  Class: croquet ball.
19.  Class: baseball.
20.  Class: loupe, jeweler's loupe.
```

<img src="https://scontent-lga3-1.cdninstagram.com/t51.2885-15/e35/12784059_1528739680760441_344179689_n.jpg" width="250" >

```
n+1: 1.  Class: wig.
n+1: 2.  Class: hair spray.
n+1: 3.  Class: oboe, hautboy, hautbois.
n+1: 4.  Class: stethoscope.
n+1: 5.  Class: Band Aid.
n+1: 6.  Class: lab coat, laboratory coat.
n+1: 7.  Class: book jacket, dust cover, dust jacket, dust wrapper.
n+1: 8.  Class: face powder.
n+1: 9.  Class: lipstick, lip rouge.
n+1: 10.  Class: jersey, T-shirt, tee shirt.
n+1: 11.  Class: bassoon.
n+1: 12.  Class: web site, website, internet site, site.
n+1: 13.  Class: lotion.
n+1: 14.  Class: neck brace.
n+1: 15.  Class: sunscreen, sunblock, sun blocker.
n+1: 16.  Class: perfume, essence.
n+1: 17.  Class: brassiere, bra, bandeau.
n+1: 18.  Class: maillot.
n+1: 19.  Class: suit, suit of clothes.
n+1: 20.  Class: syringe.
```

<img src="https://scontent-lga3-1.cdninstagram.com/t51.2885-15/s750x750/sh0.08/e35/12797842_245709435762417_302545047_n.jpg" width="250">

```
n+1: 1.  Class: candle, taper, wax light.
n+1: 2.  Class: restaurant, eating house, eating place, eatery.
n+1: 3.  Class: dining table, board.
n+1: 4.  Class: patio, terrace.
n+1: 5.  Class: grand piano, grand.
n+1: 6.  Class: altar.
n+1: 7.  Class: groom, bridegroom.
n+1: 8.  Class: tub, vat.
n+1: 9.  Class: mortar.
n+1: 10.  Class: studio couch, day bed.
n+1: 11.  Class: paper towel.
n+1: 12.  Class: pot, flowerpot.
n+1: 13.  Class: home theater, home theatre.
n+1: 14.  Class: iron, smoothing iron.
n+1: 15.  Class: lab coat, laboratory coat.
n+1: 16.  Class: red wine.
n+1: 17.  Class: abacus.
n+1: 18.  Class: scale, weighing machine.
n+1: 19.  Class: ice lolly, lolly, lollipop, popsicle.
n+1: 20.  Class: grocery store, grocery, food market, market.
```

<img src="https://scontent-lga3-1.cdninstagram.com/t51.2885-15/e35/10631999_1187324901297530_2118958455_n.jpg" width="250" >

```
n+1: 1.  Class: cellular telephone, cellular phone, cellphone, cell, mobile phone.
n+1: 2.  Class: grocery store, grocery, food market, market.
n+1: 3.  Class: shoe shop, shoe-shop, shoe store.
n+1: 4.  Class: abaya.
n+1: 5.  Class: butcher shop, meat market.
n+1: 6.  Class: fur coat.
n+1: 7.  Class: groom, bridegroom.
n+1: 8.  Class: ocarina, sweet potato.
n+1: 9.  Class: restaurant, eating house, eating place, eatery.
n+1: 10.  Class: hotdog, hot dog, red hot.
n+1: 11.  Class: pretzel.
n+1: 12.  Class: wig.
n+1: 13.  Class: hair spray.
n+1: 14.  Class: confectionery, confectionary, candy store.
n+1: 15.  Class: trench coat.
n+1: 16.  Class: bow tie, bow-tie, bowtie.
n+1: 17.  Class: cauliflower.
n+1: 18.  Class: bakery, bakeshop, bakehouse.
n+1: 19.  Class: miniskirt, mini.
n+1: 20.  Class: lipstick, lip rouge.
```

<br>

## PostGres
walk through the ubuntu installation tutorial [here](https://www.digitalocean.com/community/tutorials/how-to-install-and-use-postgresql-on-ubuntu-14-04)

guide to playing around with tables [here](https://www.digitalocean.com/community/tutorials/how-to-create-remove-manage-tables-in-postgresql-on-a-cloud-server)

There was some trouble with authentication for python/psycopg2 to connect to my postgres server. still trying piece it together myself, but I had to `ALTER USER` "postgres" and provide a password. then I modified the configuration file `pg_hba.conf` to use MD5 authentication for user "postgres" and restart the server. [check this out](https://help.ubuntu.com/stable/serverguide/postgresql.html)

```
sudo apt-get update
sudo apt-get install postgresql postgresql-contrib
sudo apt-get install python-psycopg2
sudo apt-get install libpq-dev
sudo -i -u postgres
psql

psql -d postgres    # specify which db to connect to (postgres)
\conninfo

CREATE TABLE predictions (
hash text PRIMARY KEY,
src_url text,
prediction numeric(30,25) []);

postgres=# \d
            List of relations
 Schema |    Name     | Type  |  Owner
--------+-------------+-------+----------
 public | predictions | table | postgres

 postgres=# \d predictions
  src_url    | text          | not null
  prediction | numeric(30,25) |

postgres=# ALTER TABLE predictions ADD COLUMN hash text;
  ALTER TABLE
postgres=# \d
   public | predictions | table | postgres

postgres=# \d predictions
   src_url    | text          | not null
   prediction | numeric(30,25) |
   hash       | text          |


postgres=# CREATE DATABASE image_clusters;
CREATE DATABASE

postgres=# \c image_clusters;
You are now connected to database "image_clusters" as user "postgres".
image_clusters=# CREATE TABLE predictions (
image_clusters(# hash text,
image_clusters(# src_url text,
image_clusters(# prediction numeric(30, 25) []);

image_clusters=# insert into predictions (hash, src_url, prediction) values ('a', 'a', '{100.2222222, 1000.111111111111111111, 0.55555555555555555555555, .99999999999999999999999}');

=# show data_directory; # shows where the data directory is
```

<br>

### psycopg


<br>

## MongoDB
### Installing MongoDB
RDBMS	MongoDB
Database	Database
Table	Collection
Tuple/Row	Document
column	Field
Table Join	Embedded Documents
Primary Key	Primary Key (Default key _id provided by mongodb itself)
Database Server and Client
Mysqld/Oracle	mongod
mysql/sqlplus	mongo

Find out the info of your machine. For Ubuntu:
```
$ lsb_release -a
No LSB modules are available.
Distributor ID: Ubuntu
Description:    Ubuntu 14.04.3 LTS
Release:        14.04
Codename:       trusty
```
Instructions [here](https://docs.mongodb.org/master/tutorial/install-mongodb-on-ubuntu/)
1. Import the public key.
2. Create a list file for MongoDB
3. Reload local package database.
4. Install the latest stable version of MongoDB.
5. ( ** Pin a specific version of MongoDB ** )
```
sudo apt-key adv --keyserver hkp://keyserver.ubuntu.com:80 --recv EA312927
echo "deb http://repo.mongodb.org/apt/ubuntu trusty/mongodb-org/3.2 multiverse" | sudo tee /etc/apt/sources.list.d/mongodb-org-3.2.list
sudo apt-get update
sudo apt-get install -y mongodb-org
echo "mongodb-org hold" | sudo dpkg --set-selections
echo "mongodb-org-server hold" | sudo dpkg --set-selections
echo "mongodb-org-shell hold" | sudo dpkg --set-selections
echo "mongodb-org-mongos hold" | sudo dpkg --set-selections
echo "mongodb-org-tools hold" | sudo dpkg --set-selections
```

### Running MongoDB
```
tmux new -s mongod
sudo mongod
```
Be careful: pymongo will let you insert the same document of information multiple times without error.
If you're trying to modify a document that's already in the table, use `.update_one()` or `.find_one_and_update()`

<br>
Run MongoDB Community Edition
1. Start MongoDB

    sudo service mongod start

2. Verify that MongoDB has started successfully

    [initandlisten] waiting for connections on port <port>

3. Stop MongoDB

    sudo service mongod stop

4. Restart MongoDB

    sudo service mongod restart


<br>

## rendering images on EC2
AWS ec2 instances don't have capability to render images, which poses a problem while we're trying to load images. The popular/common packages that are used to load images (`PILLOW`, `matplotlib.pyplot`, `skimage.io`) seem to rely on image render-fication.
Let's see if we can figure out how to configure `matplotlib` to suit our needs..

learn about [matplotlib's backend](http://matplotlib.org/faq/usage_faq.html#what-is-a-backend)
renderer 'AGG' seems to be working okay for reading in images.
`Note`: it's not helpful to add the command into the script. I had to modify the matplotlibrc file to get it to run properly.

<br>

## scp
Examples

Copy the file "foobar.txt" from a remote host to the local host

    $ scp your_username@remotehost.edu:foobar.txt /some/local/directory
Copy the file "foobar.txt" from the local host to a remote host

    $ scp foobar.txt your_username@remotehost.edu:/some/remote/directory
Copy the directory "foo" from the local host to a remote host's directory "bar"

    $ scp -r foo your_username@remotehost.edu:/some/remote/directory/bar
Copy the file "foobar.txt" from remote host "rh1.edu" to remote host "rh2.edu"

    $ scp your_username@rh1.edu:/some/remote/directory/foobar.txt \
your_username@rh2.edu:/some/remote/directory/
Copying the files "foo.txt" and "bar.txt" from the local host to your home directory on the remote host

    $ scp foo.txt bar.txt your_username@remotehost.edu:~
Copy the file "foobar.txt" from the local host to a remote host using port 2264

    $ scp -P 2264 foobar.txt your_username@remotehost.edu:/some/remote/directory
Copy multiple files from the remote host to your current directory on the local host

    $ scp your_username@remotehost.edu:/some/remote/directory/\{a,b,c\} .
    $ scp your_username@remotehost.edu:~/\{foo.txt,bar.txt\} .


<br>

## tmux
start new:

    tmux

start new with session name:

    tmux new -s myname

attach:

    tmux a  #  (or at, or attach)

attach to named:

    tmux a -t myname

list sessions:

    tmux ls

<a name="killSessions"></a>kill session:

    tmux kill-session -t myname

<br>

## Scraping
open up the site, open up developer tools with `cmd+option+i` and look at the network tab. the request URL for each image should be listed.


<br>

## MongoDB Structure
Store data for each item in a nested dictionary.
Dictionary top level is keyed by users.
Level two is keyed by each img.
Level three is keyed by the information of the img.

```json
{ { "user1" :
      { "img1" :
          { "key" : "special hash string identifier",
            "src_url" : "url for full image",
            "vector" : "output vector from AlexNet",
            "cluster" : "result of cluster algorithm" } },
      { "img2" :
          { "key" : "special hash string identifier",
            "src_url" : "url for full image",
            "vector" : "output vector from AlexNet",
            "cluster" : "result of cluster algorithm" } } },
    { "user2" :
        { "img1" :
            { "key" : "special hash string identifier",
              "src_url" : "url for full image",
              "vector" : "output vector from AlexNet",
              "cluster" : "result of cluster algorithm" } },
        { "img2" :
            { "key" : "special hash string identifier",
              "src_url" : "url for full image",
              "vector" : "output vector from AlexNet",
              "cluster" : "result of cluster algorithm" } } }
}
```

<br>

## Setting up Lasagne

1.Verify you have Python2.7 or Python3.4
```python
```

2. Create new environment. Make sure you switch over to that environment.
```python
conda create --name lasagne_env python=2
source activate lasagne_env
```
3. Install C compiler for OSX via pip
```python
pip install clang
```
4. Update numpy to v1.6.2 or greater. Update scipy to v0.11 or greater.
```python
conda install numpy
conda install scipy
```
5. Run command below to get the latest known good version of Theano
```python
pip install -r https://raw.githubusercontent.com/Lasagne/Lasagne/v0.1/requirements.txt
```
6. Install Lasagne
```python
pip install Lasagne==0.1
```
7.

<br>

## Troubleshooting
Ran into an issue while going through the tutorial. running example/mnist.py gave the following error:
```python
$ python mnist.py
Loading data...
Downloading train-images-idx3-ubyte.gz
Downloading train-labels-idx1-ubyte.gz
Downloading t10k-images-idx3-ubyte.gz
Downloading t10k-labels-idx1-ubyte.gz
Building model and compiling functions...
Traceback (most recent call last):
  File "mnist.py", line 359, in <module>
    main(**kwargs)
  File "mnist.py", line 281, in main
    train_fn = theano.function([input_var, target_var], loss, updates=updates)
  File "/Users/wonder/anaconda/envs/lasagne_env/lib/python2.7/site-packages/theano/compile/function.py", line 316, in function
    output_keys=output_keys)
  File "/Users/wonder/anaconda/envs/lasagne_env/lib/python2.7/site-packages/theano/compile/pfunc.py", line 523, in pfunc
    output_keys=output_keys)
  File "/Users/wonder/anaconda/envs/lasagne_env/lib/python2.7/site-packages/theano/compile/function_module.py", line 1526, in orig_function
    defaults)
  File "/Users/wonder/anaconda/envs/lasagne_env/lib/python2.7/site-packages/theano/compile/function_module.py", line 1390, in create
    input_storage=input_storage_lists)
  File "/Users/wonder/anaconda/envs/lasagne_env/lib/python2.7/site-packages/theano/gof/link.py", line 607, in make_thunk
    output_storage=output_storage)[:3]
  File "/Users/wonder/anaconda/envs/lasagne_env/lib/python2.7/site-packages/theano/gof/vm.py", line 1025, in make_all
    no_recycling))
  File "/Users/wonder/anaconda/envs/lasagne_env/lib/python2.7/site-packages/theano/gof/op.py", line 807, in make_thunk
    no_recycling)
  File "/Users/wonder/anaconda/envs/lasagne_env/lib/python2.7/site-packages/theano/gof/op.py", line 733, in make_c_thunk
    output_storage=node_output_storage)
  File "/Users/wonder/anaconda/envs/lasagne_env/lib/python2.7/site-packages/theano/gof/cc.py", line 1065, in make_thunk
    keep_lock=keep_lock)
  File "/Users/wonder/anaconda/envs/lasagne_env/lib/python2.7/site-packages/theano/gof/cc.py", line 1007, in __compile__
    keep_lock=keep_lock)
  File "/Users/wonder/anaconda/envs/lasagne_env/lib/python2.7/site-packages/theano/gof/cc.py", line 1435, in cthunk_factory
    key=key, lnk=self, keep_lock=keep_lock)
  File "/Users/wonder/anaconda/envs/lasagne_env/lib/python2.7/site-packages/theano/gof/cmodule.py", line 1094, in module_from_key
    module = lnk.compile_cmodule(location)
  File "/Users/wonder/anaconda/envs/lasagne_env/lib/python2.7/site-packages/theano/gof/cc.py", line 1347, in compile_cmodule
    preargs=preargs)
  File "/Users/wonder/anaconda/envs/lasagne_env/lib/python2.7/site-packages/theano/gof/cmodule.py", line 2068, in compile_str
    return dlimport(lib_filename)
  File "/Users/wonder/anaconda/envs/lasagne_env/lib/python2.7/site-packages/theano/gof/cmodule.py", line 297, in dlimport
    rval = __import__(module_name, {}, {}, [module_name])
ImportError: ('The following error happened while compiling the node', Dot22(Flatten{2}.0, W), '\n', 'dlopen(/Users/wonder/.theano/compiledir_Darwin-14.5.0-x86_64-i386-64bit-i386-2.7.11-64/tmp5TsaA5/15357f4a51bff61fa945bea566107bed.so, 2): Library not loaded: libmkl_intel_lp64.dylib\n  Referenced from: /Users/wonder/.theano/compiledir_Darwin-14.5.0-x86_64-i386-64bit-i386-2.7.11-64/tmp5TsaA5/15357f4a51bff61fa945bea566107bed.so\n  Reason: image not found', '[Dot22(<TensorType(float64, matrix)>, W)]')
```

Recommendation from nouiz ([here](https://groups.google.com/forum/#!topic/theano-users/DcOZvOJqxUU)) is to use the bleeding edge versions.
```python
pip install --upgrade https://github.com/Theano/Theano/archive/master.zip
pip install --upgrade https://github.com/Lasagne/Lasagne/archive/master.zip
```

Ran mnist.py again after installation. Everything went well!
  | Hardware      | Train Time    |       |
  | ------------- |:-------------:| -----:|
  | MBP (12,1)    | ~15 sec/epoch |       |
  | AWS t2.micro  | ~25 sec/epoch |       |
  | AWS g2.8xlarge| ~1.5 sec/epoch|       |
